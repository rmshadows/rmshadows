<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  

  <!-- Baidu Tongji -->
  

  <!-- Baidu Push -->
  

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc" />
  <meta name="baidu-site-verification" content="PpzM9WxOJU" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="This is CIVICCCCC&#39;s blog..." />
  <meta name="keyword" content="rmshadows,civiccccc,blog,Blog" />
  <link rel="shortcut icon" href="/rmshadows/img/avatar/roguerabbit.jpg" />

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>
  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="/rmshadows/css/bootstrap.min.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/rmshadows/css/beantech.min.css" />

  <!-- Pygments Highlight CSS -->
  
<link rel="stylesheet" href="../../css/highlight.css">
<link rel="stylesheet" href="../../css/widget.css">
<link rel="stylesheet" href="../../css/rocket.css">
<link rel="stylesheet" href="../../css/signature.css">
<link rel="stylesheet" href="../../css/catalog.css">
<link rel="stylesheet" href="../../css/livemylife.css">


  
  <!-- wave start -->
  <link rel="stylesheet" href="/rmshadows/css/wave.css" />
  <!-- wave end -->
  

  
  <!-- top start (article top hot config) -->
  <link rel="stylesheet" href="/rmshadows/css/top.css" />
  <!-- top end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/rmshadows/css/scroll.css" />
  <!-- ThemeColor end -->
  

  
  <!-- viewer start (Picture preview) -->
  <link rel="stylesheet" href="/rmshadows/css/viewer.min.css" />
  <!-- viewer end -->
  

  
  <!-- Search start -->
  <link rel="stylesheet" href="/rmshadows/css/search.css" />
  <!-- Search end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/rmshadows/css/themecolor.css" />
  <!-- ThemeColor end -->
  

  

  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
    href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://rmshadows.github.io/rmshadows/2024/OfficeNote/">
  <title>
    
    Office Notes - RYAN | be yourself
    
  </title>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="atom.xml" title="Hello ~(○｀ 3′○)~ I'm Ryan Yim" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->

<body ontouchstart="" class="body--home">
    <!-- ThemeColor -->
    
    <!-- ThemeColor -->
<!-- <div class="toggle" onclick="document.body.classList.toggle('body--dark')">Switch Color</div> -->

<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons bright-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>

    

    <!-- Navigation (contains search)-->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/rmshadows/">Hello ~(○｀ 3′○)~ I&#39;m Ryan Yim</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/rmshadows/">Home</a>
          </li>

          

          
          

          
          <li>
            <a href="/rmshadows/about/">About</a>
          </li>
          
          

          
          <li>
            <a href="/rmshadows/archive/">Archives</a>
          </li>
          
          

          
          <li>
            <a href="/rmshadows/categories/">Categories</a>
          </li>
          
          

          
          <li>
            <a href="/rmshadows/tags/">Tags</a>
          </li>
          
          

          
          <li><a class="popup-trigger" title="Search"><span class="search-icon"></span>Search</a></li>
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>


<script>
  // Drop Bootstarp low-performance Navbar
  // Use customize navbar with high-quality material design animation
  // in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


    <!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
    <!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    header.intro-header {
       /*post*/
        background-image: url('https://rmshadows.github.io/rmshadows//img/header_img/lml_bg.jpg');
      
    }

    
      #signature {/*signature*/
        background-image: url('/rmshadows/img/signature/rmshadows.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/rmshadows/tags/#Linux Applications" title="Linux Applications">Linux Applications</a>
              
              <a class="tag" href="/rmshadows/tags/#Linux Software" title="Linux Software">Linux Software</a>
              
            </div>
            <h1>Office Notes</h1>
            <h2 class="subheading">一些Office的笔记</h2>
            <span class="meta">
              Posted by Ryan Yim on
              2024-02-27
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">6</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">1.8k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            
            <!-- 不蒜子统计 start -->
            <span class="meta" id="busuanzi_container_page_pv">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



    <!-- Main Content (Post contains
    Pager、
    tip、
    socialshare、
    gitalk、gitment、disqus-comment、
    Catalog、
    Sidebar、
    Featured-Tags、
    Friends Blog、
    anchorjs、
    ) -->
    <!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h4 id="Office——WPS-Office、LibreOffice"><a href="#Office——WPS-Office、LibreOffice" class="headerlink" title="Office——WPS Office、LibreOffice"></a>Office——WPS Office、LibreOffice</h4><h5 id="LibreOffice"><a href="#LibreOffice" class="headerlink" title="LibreOffice"></a>LibreOffice</h5><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">libreoffice 命令行：Warning: failed <span class="built_in">to</span> launch javaldx - java may <span class="keyword">not</span> <span class="function"><span class="keyword">function</span> <span class="title">correctly</span></span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install libreoffice-java-common </span><br><span class="line"><span class="comment">#### libreoffice转Excel为CSV</span></span><br><span class="line">libreoffice <span class="comment">--headless --convert-to csv --outdir 【文件夹】 【Excel表格】</span></span><br></pre></td></tr></table></figure>
<h2 id="Word"><a href="#Word" class="headerlink" title="Word"></a>Word</h2><h3 id="删除文档末尾的空白页"><a href="#删除文档末尾的空白页" class="headerlink" title="删除文档末尾的空白页"></a>删除文档末尾的空白页</h3><blockquote>
<p><a href="https://baijiahao.baidu.com/s?id=1780657853654325186&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1780657853654325186&amp;wfr=spider&amp;for=pc</a><br>方法1：直接删除空白页<br>这是最简单的一种方法，你可以直接将光标放在空白页上，然后按下“Backspace”键或者“Delete”键即可删除空白页。<br>方法2：使用段落格式化功能<br>如果你有多余的段落，你可以使用段落格式化功能来删除空白页。选中需要删除的段落，然后在“段落”菜单中选择“段前段后为0”即可。<br>方法3：使用表格功能<br>如果你有一个表格，你可以使用表格功能来删除空白页。将表格转换为文本，然后删除多余的行或列即可。<br>方法4：使用查找和替换功能<br>你可以使用查找和替换功能来删除空白页。按下“Ctrl+H”组合键打开查找和替换窗口，在“查找内容”中输入“^p^p”，在“替换为”中输入“^p”，然后点击“全部替换”即可。<br>方法5：使用分隔符功能<br>如果你使用了分隔符功能来分隔文档，你可以使用它来删除空白页。在“插入”菜单中选择“分隔符”，然后在弹出的窗口中选择“分节符类型”中的“下一页”即可。</p>
</blockquote>
<h3 id="页脚插入页码出现-PAGE-MERGEFORMAT-——-页码变成了域代码的显示方式"><a href="#页脚插入页码出现-PAGE-MERGEFORMAT-——-页码变成了域代码的显示方式" class="headerlink" title="页脚插入页码出现{PAGE*MERGEFORMAT} —— 页码变成了域代码的显示方式"></a>页脚插入页码出现{PAGE*MERGEFORMAT} —— 页码变成了域代码的显示方式</h3><p>在word中点击插入页码后，按Alt + F9快捷键在显示功能变数代码与功能变数结果之间切换，即可将 “PAGE.MERGEFORMAT”变成正常页码</p>
<h2 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h2><h3 id="对比数据（行内对比）"><a href="#对比数据（行内对比）" class="headerlink" title="对比数据（行内对比）"></a>对比数据（行内对比）</h3><blockquote>
<p><a href="https://www.cijiyun.com/newsview?id=172998" target="_blank" rel="noopener">https://www.cijiyun.com/newsview?id=172998</a><br><a href="https://zhuanlan.zhihu.com/p/48789733" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/48789733</a></p>
</blockquote>
<p><strong>方法1:函数VLOOKUP</strong></p>
<p>Excel提供了一些函数来帮助我们对比两列数据。例如，我们可以使用VLOOKUP函数来查找第一列中的数值是否存在于第二列中。我们可以在第三列中使用以下公式：</p>
<p><code>=IF(ISNA(VLOOKUP(A1,$B$1:$B$10,1,FALSE)),&quot;Not Found&quot;,&quot;Found&quot;)</code></p>
<p><strong>方法2:条件格式（相同）</strong></p>
<p>使用条件格式。选中需要对比的数据范围，点击“开始”选项卡中的“条件格式”，选择“突出显示单元格规则”并选择“相等于”。在相应的对话框中，选择要对比的不同列，然后选择合适的格式和样式。这样，Excel就会将相同的数据以特定的格式进行高亮显示，方便我们找出共同点。 </p>
<p><strong>方法3:定位功能</strong></p>
<p>Excel中定位功能有一个特别方便的方法可以对比两列数据，那就是「行内容差异单元格」。其原理是，定位两列数据中同一行内单元格不同的数据，之后可以设置格式显示不同的内容。<br>选中要对比的两列数据；按下「Ctrl + G」快捷键，弹出定位菜单，点击左下角「定位条件」；其中，选择「行内容差异单元格」，点击确定；这时已经定位选中了不同的单元格，设置背景色，可以突出显示对比结果。</p>
<p><strong>方法4:使用条件格式（突出不同）</strong></p>
<p>使用条件格式不需要单独一列，可以直接在原有的数据列显示对比结果。<br>如果：E列、F列，要突出E列中不同B的单元格：<br>    选中E列对比的区域（选E列就好！）；在条件格式菜单中，点击「新建规则」；其中，选择最后一项，「使用公式确定要设置格式的单元格」；在下方输入框中，输入以下公式<code>=NOT($E1=$B1)</code>（1还是3取决于有没有表头，从第几行开始比较）；点击下方「格式」按钮，设置一填充背景色；最后点击确定完成。<br>复制条件格式请用格式刷</p>
<p><strong>方法5:使用公式（IF）</strong></p>
<p>需要另取一行：<code>=IF(B3=E3,&quot;&quot;,&quot;不一致&quot;)</code> 公式中，先用对比运算符「=」对比两个单元格，如果相同将返回TRUE，反之返回FALSE。然后使用 IF 函数，如果返回 FALSE，那么单元格显示「不一致」。</p>
<p><strong>方法6:</strong></p>
<p>WPS数据选项卡，数据对比-突出唯一值(不是行内！)</p>
<h3 id="匹配数据"><a href="#匹配数据" class="headerlink" title="匹配数据"></a>匹配数据</h3><p>已知：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>2022年度省级乡村振兴示范名单</th>
<th>2023年度推荐省级乡村振兴示范村名单</th>
<th>2023年度漳州市乡村振兴实绩突出村名单</th>
</tr>
</thead>
<tbody>
<tr>
<td>隆教乡新厝村</td>
<td>东园镇埭尾村</td>
<td>东园镇埭尾村</td>
</tr>
<tr>
<td>白水镇白水村</td>
<td>东园镇港边村</td>
<td>东园镇厚境村</td>
</tr>
<tr>
<td>程溪镇东马村</td>
<td>东泗乡下浦村</td>
<td>白水镇白水村</td>
</tr>
<tr>
<td>东园镇南边村</td>
<td>海澄镇黎明村</td>
<td>东泗乡下浦村</td>
</tr>
<tr>
<td>东园镇厚境村</td>
<td>双第农场寨仔管区</td>
<td>海澄镇埭新村</td>
</tr>
<tr>
<td>（填充）</td>
<td>港尾镇石埠村</td>
<td>海澄镇仓头村</td>
</tr>
<tr>
<td>（填充）</td>
<td>（填充）</td>
<td>浮宫镇田头村</td>
</tr>
<tr>
<td>（填充）</td>
<td>（填充）</td>
<td>浮宫镇邱厝村</td>
</tr>
<tr>
<td>（填充）</td>
<td>（填充）</td>
<td>港尾镇深沃村</td>
</tr>
<tr>
<td>（填充）</td>
<td>（填充）</td>
<td>双第农场侨星管区</td>
</tr>
</tbody>
</table>
</div>
<p>需要匹配：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">白水镇白水村</span><br><span class="line">白水镇白水村</span><br><span class="line">榜山镇上苑村</span><br><span class="line">榜山镇上苑村</span><br><span class="line">东园镇港边村</span><br><span class="line">东园镇港边村</span><br><span class="line">东园镇港边村</span><br><span class="line">东园镇港边村</span><br><span class="line">东园镇厚境村</span><br></pre></td></tr></table></figure></p>
<p>可以：</p>
<p><code>=VLOOKUP(E2,$A$1:$A$11,1,FALSE)</code>，有数值的就是匹配到的</p>
<p>或者:</p>
<p><code>=IF(ISNUMBER(MATCH(&quot;白水镇白水村&quot;,B:B,0)),&quot;找到&quot;,&quot;未找到&quot;)</code></p>
<h3 id="RANK"><a href="#RANK" class="headerlink" title="RANK"></a>RANK</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">总的来说，RANK 是较旧的函数，处理并列情况时可能会出现跳跃的排名；而 RANK.<span class="keyword">EQ</span> 返回跳过重复排名的连续排名，RANK.AVG 返回平均排名。在大多数情况下，推荐使用 RANK.<span class="keyword">EQ</span> 或 RANK.AVG，因为它们能更准确地处理并列情况。</span><br><span class="line"></span><br><span class="line">中国式排名:=SUMPRODUCT((<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">2</span>:<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">22</span>&gt;B2)/COUNTIF(<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">2</span>:<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">22</span>,<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">2</span>:<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">22</span>))+<span class="number">1</span></span><br><span class="line">格式:=SUMPRODUCT((【拍的依据的区间】&gt;【排的依据】)/COUNTIF(拍的依据的区间,拍的依据的区间))+<span class="number">1</span></span><br><span class="line">普通排名:=RANK.<span class="keyword">EQ</span>(B2,<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">2</span>:<span class="symbol">$</span>B<span class="symbol">$</span><span class="number">22</span>)</span><br><span class="line">格式：=RANK.<span class="keyword">EQ</span>(【排的依据】,【拍的依据的区间】)</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>序号</th>
<th>分数</th>
<th>=SUMPRODUCT(($B$2:$B$22&gt;B2)/COUNTIF($B$2:$B$22,$B$2:$B$22))+1</th>
<th>=RANK.EQ(B2,$B$2:$B$22)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>87.5</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>84.375</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>84.375</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>81.25</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>81.25</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>81.25</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>7</td>
<td>81.25</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>8</td>
<td>78.125</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>9</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>10</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>12</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>13</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>14</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>15</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>16</td>
<td>75</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>17</td>
<td>68.75</td>
<td>6</td>
<td>17</td>
</tr>
<tr>
<td>18</td>
<td>68.75</td>
<td>6</td>
<td>17</td>
</tr>
<tr>
<td>19</td>
<td>68.75</td>
<td>6</td>
<td>17</td>
</tr>
<tr>
<td>20</td>
<td>68.75</td>
<td>6</td>
<td>17</td>
</tr>
<tr>
<td>21</td>
<td>68.75</td>
<td>6</td>
<td>17</td>
</tr>
</tbody>
</table>
</div>
<h3 id="VLOOKUP"><a href="#VLOOKUP" class="headerlink" title="VLOOKUP"></a>VLOOKUP</h3><div class="table-container">
<table>
<thead>
<tr>
<th>员工姓名</th>
<th>部门</th>
</tr>
</thead>
<tbody>
<tr>
<td>张三</td>
<td>销售部</td>
</tr>
<tr>
<td>李四</td>
<td>人力资源部</td>
</tr>
<tr>
<td>王五</td>
<td>技术部</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>员工姓名</th>
<th>工资</th>
</tr>
</thead>
<tbody>
<tr>
<td>张三</td>
<td>5000</td>
</tr>
<tr>
<td>李四</td>
<td>6000</td>
</tr>
<tr>
<td>王五</td>
<td>7000</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">表<span class="number">1</span>匹配表<span class="number">2</span>工资：查询的表只能<span class="number">2</span>列！</span><br><span class="line">=<span class="built_in">VLOOKUP</span>(<span class="string">"张三"</span>, <span class="symbol">A:B</span>, <span class="number">2</span>, <span class="built_in">FALSE</span>)</span><br></pre></td></tr></table></figure>
<h2 id="PPT"><a href="#PPT" class="headerlink" title="PPT"></a>PPT</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id=""><a href="#" class="headerlink" title=" "></a> </h4>

        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/rmshadows/2024/Shorewall-Firewall/" data-toggle="tooltip" data-placement="top" title="Shorewall Firewall">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/rmshadows/2023/CUPS-Notes/" data-toggle="tooltip" data-placement="top" title="CUPS Notes">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <div class="tip">
          <p>
            If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
          </p>
        </div>
        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=Office Notes&body=Hi,I found this website and thought you might like it https://rmshadows.github.io/rmshadows/2024/OfficeNote/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!--修改--artalk-->
<!-- 0.artalk安装代码 -->

<!-- CSS -->
<link href="https://civiccccc.ltd/artalk/dist/Artalk.css" rel="stylesheet" />
<link href="https://civiccccc.ltd/artalk/dist/Artalk.css" rel="stylesheet" />
<!-- JS -->
<script src="https://civiccccc.ltd/artalk/dist/Artalk.js"></script>
<!-- Artalk -->
<div id="Comments"></div>
<script>
  Artalk.init({
    el: '#Comments', // 绑定元素的 Selector
    pageKey: 'https://rmshadows.github.io/2024/OfficeNote/', // 固定链接
    pageTitle: '', // 页面标题 (留空自动获取)
    server: 'https://civiccccc.ltd/artalk', // 后端地址
    site: 'CIVICCCCC的博客', // 你的站点名
  })
</script>
<!-- artalk安装代码已完成 -->



<!-- 1. gitalk comment -->



<!-- 2. gitment comment -->



<!-- 3. disqus comment -->


<!--修改--Livere-->


<!--修改--ISSO-->

        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <!--div id="toc" class="toc-article" -->
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          
            <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Office——WPS-Office、LibreOffice"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Office——WPS Office、LibreOffice</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#LibreOffice"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">LibreOffice</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Word"><span class="toc-nav-number"></span> <span class="toc-nav-text">Word</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#删除文档末尾的空白页"><span class="toc-nav-number"></span> <span class="toc-nav-text">删除文档末尾的空白页</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#页脚插入页码出现-PAGE-MERGEFORMAT-——-页码变成了域代码的显示方式"><span class="toc-nav-number"></span> <span class="toc-nav-text">页脚插入页码出现{PAGE*MERGEFORMAT} —— 页码变成了域代码的显示方式</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Excel"><span class="toc-nav-number"></span> <span class="toc-nav-text">Excel</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#对比数据（行内对比）"><span class="toc-nav-number"></span> <span class="toc-nav-text">对比数据（行内对比）</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#匹配数据"><span class="toc-nav-number"></span> <span class="toc-nav-text">匹配数据</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#RANK"><span class="toc-nav-number"></span> <span class="toc-nav-text">RANK</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#VLOOKUP"><span class="toc-nav-number"></span> <span class="toc-nav-text">VLOOKUP</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#PPT"><span class="toc-nav-number"></span> <span class="toc-nav-text">PPT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#"><span class="toc-nav-number">1.</span> <span class="toc-nav-text"> </span></a></li></ol>
          
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/rmshadows/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/rmshadows/tags/#Linux Applications" title="Linux Applications">Linux Applications</a>
            
            <a class="tag" href="/rmshadows/tags/#Linux Software" title="Linux Software">Linux Software</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://civiccccc.ltd" target="_blank">主站</a>
          </li>
          
          <li>
            <a href="https://github.com/xjx0106" target="_blank">国庆电播小弟</a>
          </li>
          
          <li>
            <a href="https://github.com/itcast-ying" target="_blank">itcast-ying</a>
          </li>
          
          <li>
            <a href="https://github.com/cjj19970505" target="_blank">Xeon-J</a>
          </li>
          
          <li>
            <a href="https://github.com/XeonKHJ" target="_blank">Xeon-H</a>
          </li>
          
          <li>
            <a href="https://gitee.com/rmshadows" target="_blank">Gitee - Ryan Yim</a>
          </li>
          
          <li>
            <a href="https://civiccccc.ltd/rmshadows/404" target="_blank">404 - No Found Page</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



    <!-- Footer (contains ThemeColor、viewer) -->
    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          
            <li>
              <a href="/rmshadows/feed.xml">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          
            <li>
              <a target="_blank" href="https://github.com/rmshadows">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          
            <li>
              <a target="_blank" href="https://www.instagram.com/just_aaaa_r">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          
            <li>
              <a target="_blank" href="https://www.zhihu.com/people/rmshadows">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa  fa-stack-1x fa-inverse">知</i>
                </span>
              </a>
            </li>
          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          Ryan Yim
          2025
          <br>
          Theme by
          <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a href="https://v-vincen.life/" target="_blank" rel="noopener">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>

<!-- jQuery -->
<script type="text/javascript" src="/rmshadows/js/jquery.min.js"></script>
<!-- <script type="text/javascript" src="/rmshadows/js/jquery.js"></script> -->
<!-- <script type="text/javascript" src="//cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->

<!-- Bootstrap Core JavaScript -->
<script type="text/javascript" src="/rmshadows/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<!--2022-03-28 添加了随机丝带特效-->

  <script type="text/javascript" src="/rmshadows/js/ribbonDynamic.js"></script>

<script type="text/javascript" src="/rmshadows/js/hux-blog.min.js"></script>

<!-- catalog -->
<script type="text/javascript" async="true" src="/rmshadows/js/catalog.js?v=1.0.0"></script>

<!-- totop(rocket) -->
<script type="text/javascript" async="true" src="/rmshadows/js/totop.js?v=1.0.0"></script>

<!-- Busuanzi JavaScript -->

  <!-- <script type="text/javascript" async="true" src="/rmshadows/js/busuanzi.pure.mini.js"></script> -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  <!-- Scroll start -->
  <script type="text/javascript" src="/rmshadows/js/scroll.js"></script>
  <!-- Scroll end -->



  <!-- ThemeColor start -->
  <script type="text/javascript" src="/rmshadows/js/themecolor.js"></script>
  <!-- ThemeColor end -->





  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  <script type="text/javascript" src="/rmshadows/js/viewer/viewer.min.js"></script>
  <script type="text/javascript" src="/rmshadows/js/viewer/pic-viewer.js"></script>
  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){ hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if($('#tag_cloud').length !== 0){ async("https://rmshadows.github.io/rmshadows/js/jquery.tagcloud.js",function(){ $.fn.tagcloud.defaults = { //size: {start: 1, end: 1, unit: 'em'}, color: {start:
'#bbbbee', end: '#0085a1'}, }; $('#tag_cloud a').tagcloud(); }) } </script> -->

    
    <!---自定义的代码 所有页面-->
    
        <script type="text/javascript" src="/rmshadows/js/on_mouse_clicked/emotions.js"></script>
    

    <!-- Search -->
    
    <div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/rmshadows/js/ziploader.js"></script>
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/rmshadows/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/rmshadows/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;

            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


    

    <!-- Image to hack wechat -->
    <!-- <img src="https://rmshadows.github.io/rmshadows/img/icon_wechat.png" width="0" height="0" /> -->
    <!-- Migrate from head to bottom, no longer block render and still work -->

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

</html>
